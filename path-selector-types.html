<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="raml-type-tree-item.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../arc-icons/arc-icons.html">

<dom-module id="path-selector-types">
  <template>
    <style>
    :host {
      display: none;
      @apply(--layout-fit);
      background-color: #fff;

      transition-property: -webkit-transform;
      transition-property: transform;

      -webkit-transition-duration: 0.3s;
      transition-duration: 0.3s;

      -webkit-transform: translate3d(100%, 0, 0);
      transform: translate3d(100%, 0, 0);
    }

    .section-title {
      @apply(--layout-horizontal);
      @apply(--layout-center);
      cursor: pointer;
    }

    .section-title h3 {
      @apply(--layout-flex);
      padding-left: 0;
    }

    .back-button {
      color: var(--raml-path-selector-back-icon-color, rgba(0, 0, 0, 0.54));
      transition: color 0.25s linear;
    }

    .back-button:hover {
      color: var(--raml-path-selector-back-icon-color-hover, rgba(0, 0, 0, 0.87));
    }
    </style>
    <template is="dom-if" if="[[opened]]">
      <div class="section-title">
        <paper-icon-button on-tap="back" class="back-button" icon="arc:arrow-back"></paper-icon-button>
        <h3>Types</h3>
      </div>
      <template is="dom-repeat" items="[[types]]">
        <raml-type-tree-item
          indent="1"
          indent-size="24"
          selected-path="[[selectedPath]]"
          type="[[item]]"
          path="types.[[index]]"></raml-type-tree-item>
      </template>
    </template>
  </template>
  <script>
    Polymer({
      is: 'path-selector-types',
      properties: {
        selectedPath: String,
        /**
         * List of types nodes.
         */
        types: Array,
        // If set this view is being displayed.
        opened: {
          type: Boolean,
          observer: '_openedChanged'
        }
      },

      back: function() {
        this.fire('raml-path-selector-nav-back');
      },

      _openedChanged: function(opened) {
        if (opened) {
          this.style.display = 'block';
          if (this.__closeTimer) {
            this.cancelAsync(this.__closeTimer);
            this.__closeTimer = undefined;
          }
          Polymer.RenderStatus.afterNextRender(this, function() {
            this.transform('translate3d(0, 0, 0)');
          });
        } else {
          this.transform('translate3d(100%, 0, 0)');
          this.__closeTimer = this.async(function() {
            this.style.display = 'none';
          }, 300);
        }
      }
    });
  </script>
</dom-module>
